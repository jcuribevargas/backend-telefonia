generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  schemas  = ["db_telefonia"]
}

model Role {
  id_role     Int       @id @default(autoincrement())
  descripcion String?   @db.VarChar(45)
  usuarios    Usuario[]

  @@map("roles")
  @@schema("db_telefonia")
}

model TipoDocumento {
  id_tipo_documento Int       @id @default(autoincrement())
  descripcion       String    @db.VarChar(45)
  usuarios          Usuario[]

  @@map("tipo_documentos")
  @@schema("db_telefonia")
}

model Producto {
  id_producto    Int         @id @default(autoincrement())
  referencia     String      @db.VarChar(45)
  pantalla       String?     @db.VarChar(45)
  almacenamiento Int
  ram            Int
  imagen         String?     @db.VarChar(100)
  stock          Int?        @default(0)
  precio_costo   Int?
  precio_venta   Int?
  items          ItemVenta[]

  @@unique([referencia, ram, almacenamiento], map: "producto_unique")
  @@map("productos")
  @@schema("db_telefonia")
}

model Usuario {
  id_usuario            Int           @id
  numero_identificacion String?       @db.VarChar(25)
  correo                String        @unique @db.VarChar(100)
  direccion             String?       @db.VarChar(100)
  telefono              String?       @db.VarChar(45)
  id_role_fk            Int
  id_tipo_documento     Int
  nombre                String        @db.VarChar(100)
  clave                 String?
  role                  Role          @relation(fields: [id_role_fk], references: [id_role], onDelete: NoAction, onUpdate: NoAction, map: "fk_roles_usuarios")
  tipo_documentos       TipoDocumento @relation(fields: [id_tipo_documento], references: [id_tipo_documento], onDelete: NoAction, onUpdate: NoAction, map: "fk_tipodoc_usuarios")
  ventas                Venta[]

  @@unique([id_tipo_documento, numero_identificacion], map: "identificacion_unique")
  @@map("usuarios")
  @@schema("db_telefonia")
}

model Venta {
  id_venta       BigInt      @id @default(autoincrement())
  numero_factura String      @unique @db.VarChar(45)
  fecha_venta    DateTime    @db.Date
  total          BigInt?
  id_usuario_fk  Int?
  items          ItemVenta[]
  usuario        Usuario?    @relation(fields: [id_usuario_fk], references: [id_usuario], onDelete: NoAction, onUpdate: NoAction, map: "fk_usuarios_ventas")

  @@map("ventas")
  @@schema("db_telefonia")
}

model ItemVenta {
  id_item        Int
  id_venta_fk    BigInt
  id_producto_fk Int
  stock_vendido  Int
  precio_venta   Int
  Producto       Producto @relation(fields: [id_producto_fk], references: [id_producto], onDelete: NoAction, onUpdate: NoAction, map: "fk_productos_items")
  Venta          Venta    @relation(fields: [id_venta_fk], references: [id_venta], onDelete: NoAction, onUpdate: NoAction, map: "fk_ventas_items")

  @@id([id_item, id_venta_fk])
  @@unique([id_venta_fk, id_item], map: "item_unique")
  @@map("items_ventas")
  @@schema("db_telefonia")
}
